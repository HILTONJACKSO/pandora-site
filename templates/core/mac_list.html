{% extends 'base.html' %}

{% block title %}Manage MACs{% endblock %}
{% block page_title %}MAC Management{% endblock %}

{% block content %}
<!-- Stats -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-card-header">
            <span class="stat-card-title">Total MACs</span>
            <div class="stat-card-icon" style="background: #dbeafe; color: var(--primary);">
                <i class="fas fa-building"></i>
            </div>
        </div>
        <div class="stat-card-value">{{ mac_counts.all }}</div>
    </div>
    
    <div class="stat-card success">
        <div class="stat-card-header">
            <span class="stat-card-title">Active MACs</span>
            <div class="stat-card-icon" style="background: #d1fae5; color: var(--success);">
                <i class="fas fa-check-circle"></i>
            </div>
        </div>
        <div class="stat-card-value">{{ mac_counts.active }}</div>
    </div>
</div>

<!-- Search and Actions -->
<div class="card">
    <div class="card-body">
        <div class="d-flex justify-between align-center" style="flex-wrap: wrap; gap: 15px;">
            <form method="get" class="d-flex gap-2" style="flex: 1;">
                <input type="text" 
                       name="search" 
                       placeholder="Search by name or acronym..." 
                       value="{{ search_query }}"
                       style="flex: 1; min-width: 250px;">
                
                <select name="status">
                    <option value="">All Status</option>
                    <option value="active" {% if current_status == 'active' %}selected{% endif %}>Active</option>
                    <option value="inactive" {% if current_status == 'inactive' %}selected{% endif %}>Inactive</option>
                </select>
                
                <button type="submit" class="btn btn-primary">
                    {% comment %} <i class="fas fa-search"></i>  {% endcomment %}
                    Search
                </button>
            </form>
            
            <a href="{% url 'mac_create' %}" class="btn btn-primary">
                <i class="fas fa-plus"></i> New MAC
            </a>
        </div>
    </div>
</div>

<!-- MACs List -->
<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px;">
    {% for mac in macs %}
    <div class="card">
        <div class="card-body">
            <div class="d-flex justify-between align-center" style="margin-bottom: 15px;">
                <h3 style="margin: 0;">{{ mac.acronym }}</h3>
                {% if mac.is_active %}
                <span class="badge badge-success">Active</span>
                {% else %}
                <span class="badge badge-secondary">Inactive</span>
                {% endif %}
            </div>
            
            <p style="font-weight: 500; margin: 10px 0;">{{ mac.name }}</p>
            
            {% if mac.description %}
            <p style="font-size: 0.9rem; color: var(--secondary); margin: 10px 0;">
                {{ mac.description|truncatewords:20 }}
            </p>
            {% endif %}
            
            {% if mac.email %}
            <p style="margin: 8px 0; font-size: 0.9rem;">
                <i class="fas fa-envelope"></i> {{ mac.email }}
            </p>
            {% endif %}
            
            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border);">
                <div style="display: flex; gap: 10px; font-size: 0.9rem; color: var(--secondary);">
                    <span><i class="fas fa-users"></i> {{ mac.users.count }} users</span>
                    <span><i class="fas fa-file-alt"></i> {{ mac.submissions.count }} submissions</span>
                </div>
            </div>
            
            <div class="d-flex gap-2" style="margin-top: 15px;">
                <a href="{% url 'mac_edit' mac.pk %}" class="btn btn-sm btn-secondary">
                    <i class="fas fa-edit"></i> Edit
                </a>
                <a href="{% url 'mac_delete' mac.pk %}" class="btn btn-sm btn-danger">
                    <i class="fas fa-trash"></i> Delete
                </a>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="card" style="grid-column: 1 / -1;">
        <div class="card-body text-center" style="padding: 60px 0;">
            <i class="fas fa-building" style="font-size: 3rem; opacity: 0.2; display: block; margin-bottom: 15px;"></i>
            <p class="text-muted">No MACs found.</p>
            <a href="{% url 'mac_create' %}" class="btn btn-primary" style="margin-top: 15px;">
                <i class="fas fa-plus"></i> Create First MAC
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}